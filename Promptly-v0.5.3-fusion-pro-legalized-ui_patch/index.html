
<!doctype html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Promptly v0.5.3-fusion PRO — Demo</title>
  <link rel="stylesheet" href="style.css" />
<style>
/* === v0.5.3 UI Patch: gradients, titles, numbers, footer === */
:root{
  --brand-1:#7C3AED; /* violet-600 */
  --brand-2:#06B6D4; /* cyan-500 */
  --brand-3:#22D3EE; /* cyan-400 */
  --brand-4:#4ADE80; /* green-400 */
  --brand-5:#F59E0B; /* amber-500 */
  --cool-grey-1:#E5E7EB; /* gray-200 */
  --cool-grey-2:#9CA3AF; /* gray-400 */
  --cool-grey-3:#6B7280; /* gray-500 */
}
.gradient-animated{
  background: linear-gradient(90deg,var(--brand-1),var(--brand-2),var(--brand-3),var(--brand-4),var(--brand-5));
  background-size: 300% 300%;
  -webkit-background-clip: text;
  background-clip:text;
  color: transparent !important;
  animation: hueShift 8s ease-in-out infinite;
}
.gradient-animated-subtle{
  background: linear-gradient(90deg,var(--brand-2),var(--brand-3));
  background-size: 200% 200%;
  -webkit-background-clip: text;
  background-clip:text;
  color: transparent !important;
  animation: hueShift 10s linear infinite;
  opacity: .95;
}
.grey-gradient-text{
  background: linear-gradient(180deg,var(--cool-grey-1),var(--cool-grey-3));
  -webkit-background-clip: text;
  background-clip:text;
  color: transparent !important;
}
.metric-title{
  font-weight: 700;
  letter-spacing: .2px;
}
.metric-value, .kpi-value, .stat-number, .stat-value{
  font-weight: 800;
}
.copyright-symbol{
  color: var(--brand-2);
  font-weight: 800;
}
.footer-split{ line-height: 1.4; display:block; }
@keyframes hueShift{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
/* Heuristics: make large numbers in cards grey-gradient even if no class is present */
.kpi-card h1, .kpi-card h2, .kpi-card .value, .card .value, .stat h2, .stat .value{
  background: linear-gradient(180deg,var(--cool-grey-1),var(--cool-grey-3));
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  font-weight:800;
}
</style>
</head>
<body>
  <header class="topbar">
    <div class="brand gradient-text">Promptly</div>
    <nav class="controls">
      <div class="navlinks">
        <a href="index.html" data-i18n="nav_home">Dashboard</a>
        <a href="privacy.html" data-i18n="nav_privacy">Privacy</a>
        <a href="terms.html" data-i18n="nav_terms">Terms</a>
        <a href="cookies.html" data-i18n="nav_cookies">Cookies</a>
      </div>
      <label class="control"><span data-i18n="appearance">System</span>
        <select id="themeSelect"><option value="auto" data-i18n="auto">System</option><option value="light" data-i18n="light">Light</option><option value="dark" data-i18n="dark">Dark</option></select>
      </label>
      <label class="control"><span data-i18n="language">English</span>
        <select id="langSelect"></select>
      </label>
    </nav>
  </header>

  <main class="container">
    <div class="hero">
      <div>
        <div class="title gradient-text" data-i18n="hero_title">Promptly — Prompt Optimizer Studio</div>
        <div class="subtitle" data-i18n="hero_subtitle">Visualization-first workflow. See every gain, every cost, every version.</div>
      </div>
    </div>

    <section class="grid grid-2">
      <div class="card">
        <h3 data-i18n="task_label">Task</h3>
        <textarea id="task" rows="4" placeholder="e.g., Classify sentiment of a sentence; output POS or NEG only."></textarea>
        <h3 style="margin-top:12px" data-i18n="examples_label">Examples (optional)</h3>
        <textarea id="examples" rows="4">POS || I love this!
NEG || This is terrible.</textarea>
        <button id="runBtn" class="btn" style="margin-top:12px" data-i18n="run_btn">Run Optimization</button>
      </div>

      <div class="card">
        <h3 class="gradient-text" data-i18n="best_prompt">Best Prompt</h3>
        <textarea id="bestPrompt" class="codeblock" rows="10"></textarea>
      </div>
    </section>

    <section class="grid grid-4" style="margin-top:16px">
      <div class="card kpi" id="kAcc">
        <span class="label" data-i18n="kpi_accuracy">Accuracy</span>
        <span class="value" id="valAcc">—</span>
        <span class="delta" id="deltaAcc">+0.00%</span>
      </div>
      <div class="card kpi">
        <span class="label" data-i18n="kpi_f1">F1</span>
        <span class="value" id="valF1">—</span>
        <span class="delta">&nbsp;</span>
      </div>
      <div class="card kpi">
        <span class="label" data-i18n="kpi_pass">Pass Rate</span>
        <span class="value" id="valPass">—</span>
        <span class="delta">&nbsp;</span>
      </div>
      <div class="card kpi">
        <span class="label" data-i18n="kpi_cost">Token Cost</span>
        <span class="value" id="valCost">—</span>
        <span class="delta">&nbsp;</span>
      </div>
      <div class="card kpi">
        <span class="label" data-i18n="kpi_prog">Progress %</span>
        <span class="value" id="valProg">—</span>
        <span class="delta">&nbsp;</span>
      </div>
    </section>

    <section class="grid grid-2" style="margin-top:16px">
      <div class="card">
        <h3 class="gradient-text" data-i18n="growth_chart">Growth Over Iterations</h3>
        <canvas id="lineGrowth" class="canvas"></canvas>
      </div>
      <div class="card">
        <h3 class="gradient-text" data-i18n="contrib_chart">Change Contribution</h3>
        <canvas id="barContrib" class="canvas"></canvas>
      </div>
      <div class="card">
        <h3 class="gradient-text" data-i18n="pass_pie">Pass vs Fail (%)</h3>
        <canvas id="piePass" class="canvas"></canvas>
      </div>
      <div class="card">
        <h3 class="gradient-text" data-i18n="gauge">Progress Meter (%)</h3>
        <canvas id="gaugeProg" class="canvas"></canvas>
      </div>
    </section>

    <section class="card" style="margin-top:16px">
      <h3 class="gradient-text" data-i18n="versions">Prompt Versions</h3>
      <div id="verList" class="list"></div>
    </section>
  </main>

  <footer class="footer">
    <p>© Promptly v0.5.3-fusion PRO · <span data-i18n="footer_rights">No trackers. Preferences saved only after consent.</span> · <span data-i18n="footer_contact">Support</span>:
      <a href="mailto:ming.t.yang@vanderbilt.edu">ming.t.yang@vanderbilt.edu</a></p>
  </footer>

  <script src="core.js"></script>
<script>
// === v0.5.3 UI Patch (non-invasive) ===
(function(){
  const TITLES = [
    {key:'accuracy', labels:['Accuracy']},
    {key:'f1', labels:['F1']},
    {key:'pass_rate', labels:['Pass Rate','PassRate']},
    {key:'token_cost', labels:['Token Cost','Token']},
    {key:'progress', labels:['Progress %','Progress%','Progress']}
  ];

  function wrapMetricTitlesAndValues(){
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT, null);
    const nodes = [];
    while(walker.nextNode()){ nodes.push(walker.currentNode); }
    nodes.forEach(node => {
      const txt = (node.textContent || '').trim();
      TITLES.forEach(t => {
        t.labels.forEach(label => {
          if(txt === label){
            node.classList.add('metric-title','gradient-animated-subtle');
            node.setAttribute('data-i18n-key', t.key);
            // find a sibling/child numeric value to style
            let valueEl = null;
            // Search next siblings first
            let sib = node.parentElement && node.parentElement.querySelector('*');
            // broader search within same card/container
            const container = node.closest('.card, .kpi-card, .metric, .stat, .tile, .panel') || node.parentElement;
            if(container){
              const candidates = Array.from(container.querySelectorAll('h1,h2,h3,div,span,strong,em'))
                .filter(el=>/^(\d+(\.\d+)?%?|\$?\d[\d\.,]*)$/.test((el.textContent||'').trim()));
              if(candidates.length){
                // pick the one with largest font-size (heuristic)
                candidates.sort((a,b)=>parseFloat(getComputedStyle(b).fontSize)-parseFloat(getComputedStyle(a).fontSize));
                valueEl = candidates[0];
              }
            }
            if(valueEl){
              valueEl.classList.add('metric-value','grey-gradient-text');
              valueEl.setAttribute('data-i18n-key', t.key+'_value'); // values usually numbers; keep for completeness
            }
          }
        });
      });
    });
  }

  function patchFooter(){
    const footers = Array.from(document.querySelectorAll('footer, .footer, #footer, [role="contentinfo"]'));
    let target = footers[0];
    if(!target){
      // try to find an element containing "Promptly v0.5.3"
      target = Array.from(document.querySelectorAll('div,section,p,small')).find(el=>/Promptly\s*v0\.5\.3/i.test(el.textContent||''));
    }
    if(!target) return;
    const text = target.textContent || '';
    // Build split footer
    const supportEmail = (text.match(/[\w.+-]+@[\w.-]+\.[A-Za-z]{2,}/) || [null,''])[0] || 'support@example.com';
    const html = [
      '<span class="footer-split"><span class="copyright-symbol">©</span> <span class="gradient-animated" id="promptly-brand">Promptly</span> v0.5.3-fusion PRO</span>',
      '<span class="footer-split">No trackers. Preferences saved only after consent.</span>',
      '<span class="footer-split">Support: <a href="mailto:'+supportEmail+'">'+supportEmail+'</a></span>'
    ].join('');
    target.innerHTML = html;
  }

  // Lightweight i18n for key labels (fallback to English)
  const i18n = {
    en:{ 'accuracy':'Accuracy','f1':'F1','pass_rate':'Pass Rate','token_cost':'Token Cost','progress':'Progress %','user_guide':'User Guide','language':'Language'},
    zh:{ 'accuracy':'准确率','f1':'F1','pass_rate':'通过率','token_cost':'Token 费用','progress':'进度 %','user_guide':'使用说明','language':'语言'},
    es:{ 'accuracy':'Precisión','f1':'F1','pass_rate':'Tasa de éxito','token_cost':'Costo de tokens','progress':'Progreso %','user_guide':'Guía de uso','language':'Idioma'},
    fr:{ 'accuracy':'Précision','f1':'F1','pass_rate':'Taux de réussite','token_cost':'Coût des jetons','progress':'Progression %','user_guide':'Guide d’utilisation','language':'Langue'},
    hi:{ 'accuracy':'शुद्धता','f1':'F1','pass_rate':'पास दर','token_cost':'टोकन लागत','progress':'प्रगति %','user_guide':'उपयोग गाइड','language':'भाषा'},
    ar:{ 'accuracy':'الدقة','f1':'F1','pass_rate':'معدل النجاح','token_cost':'تكلفة الرموز','progress':'التقدم %','user_guide':'دليل الاستخدام','language':'اللغة'},
    pt:{ 'accuracy':'Acurácia','f1':'F1','pass_rate':'Taxa de aprovação','token_cost':'Custo de tokens','progress':'Progresso %','user_guide':'Guia do usuário','language':'Idioma'},
    ja:{ 'accuracy':'正確度','f1':'F1','pass_rate':'合格率','token_cost':'トークン費用','progress':'進捗 %','user_guide':'ユーザーガイド','language':'言語'},
    ko:{ 'accuracy':'정확도','f1':'F1','pass_rate':'통과율','token_cost':'토큰 비용','progress':'진행률 %','user_guide':'사용자 가이드','language':'언어'}
  };

  function applyLang(lang){
    const dict = i18n[lang] || i18n.en;
    document.querySelectorAll('[data-i18n-key]').forEach(el=>{
      const key = el.getAttribute('data-i18n-key');
      if(dict[key]){
        el.textContent = dict[key];
      }
    });
    document.documentElement.setAttribute('lang', lang);
  }

  function hookLanguageSelector(){
    const selects = Array.from(document.querySelectorAll('#language, #lang, select[name="language"], select#langSelect, select[data-role="language"]'));
    if(!selects.length){
      // build a simple selector if not present
      const header = document.querySelector('header') || document.body;
      const wrapper = document.createElement('div');
      wrapper.style.position='fixed'; wrapper.style.top='12px'; wrapper.style.right='12px'; wrapper.style.zIndex=1000;
      wrapper.innerHTML = '<select id="langSelectPatched" style="padding:.4rem .6rem;border-radius:8px;outline:none;">'
        +'<option value="en">English</option>'
        +'<option value="zh">中文</option>'
        +'<option value="es">Español</option>'
        +'<option value="fr">Français</option>'
        +'<option value="hi">हिन्दी</option>'
        +'<option value="ar">العربية</option>'
        +'<option value="pt">Português</option>'
        +'<option value="ja">日本語</option>'
        +'<option value="ko">한국어</option>'
        +'</select>';
      header.appendChild(wrapper);
      const sel = wrapper.querySelector('select');
      sel.addEventListener('change', e=>applyLang(e.target.value));
      applyLang('en');
    }else{
      selects.forEach(sel=>{
        sel.addEventListener('change', e=>applyLang(e.target.value));
      });
      // initialize to current value or 'en'
      const cur = selects[0].value || 'en';
      applyLang(cur);
    }
  }

  function ensureUserGuide(){
    if(document.querySelector('#user-guide')) return;
    const section = document.createElement('section');
    section.id = 'user-guide';
    section.style.margin='48px auto';
    section.style.maxWidth='960px';
    section.innerHTML = `
      <h2 class="gradient-animated" data-i18n-key="user_guide" style="font-size:1.6rem;margin-bottom:12px;">User Guide</h2>
      <ol style="line-height:1.7;margin-left:18px;margin-bottom:16px;">
        <li><strong>Write your task</strong>: define <em>Instruction</em> + <em>Constraints</em> + <em>Expected style</em>.</li>
        <li><strong>Add test cases</strong>: for each input, provide <em>ideal output</em>.</li>
        <li><strong>Run</strong>: the system auto-searches, tests, and tunes prompts.</li>
        <li><strong>Review KPIs</strong>: Accuracy / F1 / Pass Rate / Token Cost / Progress% update after each run.</li>
      </ol>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;">
        <div><img src="assets/placeholder_line.png" alt="Accuracy trend" style="width:100%;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,.25)"><p style="opacity:.7;margin-top:6px">Accuracy Trend</p></div>
        <div><img src="assets/placeholder_pie.png" alt="Error breakdown" style="width:100%;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,.25)"><p style="opacity:.7;margin-top:6px">Error Breakdown</p></div>
        <div><img src="assets/placeholder_gauge.png" alt="Progress gauge" style="width:100%;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,.25)"><p style="opacity:.7;margin-top:6px">Progress Gauge</p></div>
      </div>
      <h3 style="margin-top:16px" class="gradient-animated">Instances</h3>
      <pre style="white-space:pre-wrap;background:rgba(255,255,255,.04);padding:12px;border-radius:12px">
1) Summarization
   Instruction: "Summarize the article in 3 bullet points. Tone: neutral."
   Test: input: {url: "..."} → ideal: "- point A\n- point B\n- point C"

2) Email draft
   Instruction: "Write a warm reply confirming availability on Tuesday 3pm."
   Test: input: {thread:"..."} → ideal: "Warm, polite confirmation with time."
      </pre>
      <h3 style="margin-top:16px" class="gradient-animated">Glossary</h3>
      <ul style="line-height:1.7">
        <li><strong data-i18n-key="accuracy">Accuracy</strong>: correct outputs / all tests.</li>
        <li><strong data-i18n-key="f1">F1</strong>: harmonic mean of precision & recall (0–1).</li>
        <li><strong data-i18n-key="pass_rate">Pass Rate</strong>: tests passed with a threshold.</li>
        <li><strong data-i18n-key="token_cost">Token Cost</strong>: total tokens used (proxy for $$).</li>
        <li><strong data-i18n-key="progress">Progress %</strong>: optimization completion estimate.</li>
      </ul>
    `;
    document.body.appendChild(section);
  }

  function init(){
    try{ wrapMetricTitlesAndValues(); }catch(e){}
    try{ patchFooter(); }catch(e){}
    try{ ensureUserGuide(); }catch(e){}
    try{ hookLanguageSelector(); }catch(e){}
  }

  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', init);
  }else{
    init();
  }
})();
</script>
</body>
</html>
